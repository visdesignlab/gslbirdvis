(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();var Te={value:()=>{}};function ae(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new _t(n)}function _t(t){this._=t}function Le(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}_t.prototype=ae.prototype={constructor:_t,on:function(t,e){var n=this._,r=Le(t+"",n),o,i=-1,s=r.length;if(arguments.length<2){for(;++i<s;)if((o=(t=r[i]).type)&&(o=Re(n[o],t.name)))return o;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++i<s;)if(o=(t=r[i]).type)n[o]=qt(n[o],t.name,e);else if(e==null)for(o in n)n[o]=qt(n[o],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new _t(t)},call:function(t,e){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,i;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],o=0,i=r.length;o<i;++o)r[o].value.apply(e,n)}};function Re(t,e){for(var n=0,r=t.length,o;n<r;++n)if((o=t[n]).name===e)return o.value}function qt(t,e,n){for(var r=0,o=t.length;r<o;++r)if(t[r].name===e){t[r]=Te,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Ct="http://www.w3.org/1999/xhtml";const Gt={svg:"http://www.w3.org/2000/svg",xhtml:Ct,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function $t(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Gt.hasOwnProperty(e)?{space:Gt[e],local:t}:t}function ze(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Ct&&e.documentElement.namespaceURI===Ct?e.createElement(t):e.createElementNS(n,t)}}function Oe(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function le(t){var e=$t(t);return(e.local?Oe:ze)(e)}function De(){}function Yt(t){return t==null?De:function(){return this.querySelector(t)}}function Ye(t){typeof t!="function"&&(t=Yt(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i=e[o],s=i.length,a=r[o]=new Array(s),c,u,l=0;l<s;++l)(c=i[l])&&(u=t.call(c,c.__data__,l,i))&&("__data__"in c&&(u.__data__=c.__data__),a[l]=u);return new U(r,this._parents)}function Pe(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Xe(){return[]}function ce(t){return t==null?Xe:function(){return this.querySelectorAll(t)}}function Fe(t){return function(){return Pe(t.apply(this,arguments))}}function Ue(t){typeof t=="function"?t=Fe(t):t=ce(t);for(var e=this._groups,n=e.length,r=[],o=[],i=0;i<n;++i)for(var s=e[i],a=s.length,c,u=0;u<a;++u)(c=s[u])&&(r.push(t.call(c,c.__data__,u,s)),o.push(c));return new U(r,o)}function ue(t){return function(){return this.matches(t)}}function de(t){return function(e){return e.matches(t)}}var He=Array.prototype.find;function qe(t){return function(){return He.call(this.children,t)}}function Ge(){return this.firstElementChild}function Je(t){return this.select(t==null?Ge:qe(typeof t=="function"?t:de(t)))}var Ve=Array.prototype.filter;function We(){return Array.from(this.children)}function je(t){return function(){return Ve.call(this.children,t)}}function Ze(t){return this.selectAll(t==null?We:je(typeof t=="function"?t:de(t)))}function Ke(t){typeof t!="function"&&(t=ue(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i=e[o],s=i.length,a=r[o]=[],c,u=0;u<s;++u)(c=i[u])&&t.call(c,c.__data__,u,i)&&a.push(c);return new U(r,this._parents)}function fe(t){return new Array(t.length)}function Qe(){return new U(this._enter||this._groups.map(fe),this._parents)}function wt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}wt.prototype={constructor:wt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function tn(t){return function(){return t}}function en(t,e,n,r,o,i){for(var s=0,a,c=e.length,u=i.length;s<u;++s)(a=e[s])?(a.__data__=i[s],r[s]=a):n[s]=new wt(t,i[s]);for(;s<c;++s)(a=e[s])&&(o[s]=a)}function nn(t,e,n,r,o,i,s){var a,c,u=new Map,l=e.length,f=i.length,p=new Array(l),y;for(a=0;a<l;++a)(c=e[a])&&(p[a]=y=s.call(c,c.__data__,a,e)+"",u.has(y)?o[a]=c:u.set(y,c));for(a=0;a<f;++a)y=s.call(t,i[a],a,i)+"",(c=u.get(y))?(r[a]=c,c.__data__=i[a],u.delete(y)):n[a]=new wt(t,i[a]);for(a=0;a<l;++a)(c=e[a])&&u.get(p[a])===c&&(o[a]=c)}function rn(t){return t.__data__}function on(t,e){if(!arguments.length)return Array.from(this,rn);var n=e?nn:en,r=this._parents,o=this._groups;typeof t!="function"&&(t=tn(t));for(var i=o.length,s=new Array(i),a=new Array(i),c=new Array(i),u=0;u<i;++u){var l=r[u],f=o[u],p=f.length,y=sn(t.call(l,l&&l.__data__,u,r)),v=y.length,h=a[u]=new Array(v),_=s[u]=new Array(v),T=c[u]=new Array(p);n(l,f,h,_,T,y,e);for(var d=0,m=0,g,x;d<v;++d)if(g=h[d]){for(d>=m&&(m=d+1);!(x=_[m])&&++m<v;);g._next=x||null}}return s=new U(s,r),s._enter=a,s._exit=c,s}function sn(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function an(){return new U(this._exit||this._groups.map(fe),this._parents)}function ln(t,e,n){var r=this.enter(),o=this,i=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(o=e(o),o&&(o=o.selection())),n==null?i.remove():n(i),r&&o?r.merge(o).order():o}function cn(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,o=n.length,i=r.length,s=Math.min(o,i),a=new Array(o),c=0;c<s;++c)for(var u=n[c],l=r[c],f=u.length,p=a[c]=new Array(f),y,v=0;v<f;++v)(y=u[v]||l[v])&&(p[v]=y);for(;c<o;++c)a[c]=n[c];return new U(a,this._parents)}function un(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],o=r.length-1,i=r[o],s;--o>=0;)(s=r[o])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function dn(t){t||(t=fn);function e(f,p){return f&&p?t(f.__data__,p.__data__):!f-!p}for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var s=n[i],a=s.length,c=o[i]=new Array(a),u,l=0;l<a;++l)(u=s[l])&&(c[l]=u);c.sort(e)}return new U(o,this._parents).order()}function fn(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function pn(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function hn(){return Array.from(this)}function yn(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],o=0,i=r.length;o<i;++o){var s=r[o];if(s)return s}return null}function mn(){let t=0;for(const e of this)++t;return t}function gn(){return!this.node()}function _n(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var o=e[n],i=0,s=o.length,a;i<s;++i)(a=o[i])&&t.call(a,a.__data__,i,o);return this}function xn(t){return function(){this.removeAttribute(t)}}function vn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function wn(t,e){return function(){this.setAttribute(t,e)}}function bn(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function kn(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function En(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function An(t,e){var n=$t(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?vn:xn:typeof e=="function"?n.local?En:kn:n.local?bn:wn)(n,e))}function pe(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function In(t){return function(){this.style.removeProperty(t)}}function $n(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Mn(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Nn(t,e,n){return arguments.length>1?this.each((e==null?In:typeof e=="function"?Mn:$n)(t,e,n??"")):rt(this.node(),t)}function rt(t,e){return t.style.getPropertyValue(e)||pe(t).getComputedStyle(t,null).getPropertyValue(e)}function Sn(t){return function(){delete this[t]}}function Bn(t,e){return function(){this[t]=e}}function Cn(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Tn(t,e){return arguments.length>1?this.each((e==null?Sn:typeof e=="function"?Cn:Bn)(t,e)):this.node()[t]}function he(t){return t.trim().split(/^|\s+/)}function Pt(t){return t.classList||new ye(t)}function ye(t){this._node=t,this._names=he(t.getAttribute("class")||"")}ye.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function me(t,e){for(var n=Pt(t),r=-1,o=e.length;++r<o;)n.add(e[r])}function ge(t,e){for(var n=Pt(t),r=-1,o=e.length;++r<o;)n.remove(e[r])}function Ln(t){return function(){me(this,t)}}function Rn(t){return function(){ge(this,t)}}function zn(t,e){return function(){(e.apply(this,arguments)?me:ge)(this,t)}}function On(t,e){var n=he(t+"");if(arguments.length<2){for(var r=Pt(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof e=="function"?zn:e?Ln:Rn)(n,e))}function Dn(){this.textContent=""}function Yn(t){return function(){this.textContent=t}}function Pn(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Xn(t){return arguments.length?this.each(t==null?Dn:(typeof t=="function"?Pn:Yn)(t)):this.node().textContent}function Fn(){this.innerHTML=""}function Un(t){return function(){this.innerHTML=t}}function Hn(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function qn(t){return arguments.length?this.each(t==null?Fn:(typeof t=="function"?Hn:Un)(t)):this.node().innerHTML}function Gn(){this.nextSibling&&this.parentNode.appendChild(this)}function Jn(){return this.each(Gn)}function Vn(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Wn(){return this.each(Vn)}function jn(t){var e=typeof t=="function"?t:le(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Zn(){return null}function Kn(t,e){var n=typeof t=="function"?t:le(t),r=e==null?Zn:typeof e=="function"?e:Yt(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Qn(){var t=this.parentNode;t&&t.removeChild(this)}function tr(){return this.each(Qn)}function er(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function nr(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function rr(t){return this.select(t?nr:er)}function or(t){return arguments.length?this.property("__data__",t):this.node().__data__}function ir(t){return function(e){t.call(this,e,this.__data__)}}function sr(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function ar(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,o=e.length,i;n<o;++n)i=e[n],(!t.type||i.type===t.type)&&i.name===t.name?this.removeEventListener(i.type,i.listener,i.options):e[++r]=i;++r?e.length=r:delete this.__on}}}function lr(t,e,n){return function(){var r=this.__on,o,i=ir(e);if(r){for(var s=0,a=r.length;s<a;++s)if((o=r[s]).type===t.type&&o.name===t.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=n),o.value=e;return}}this.addEventListener(t.type,i,n),o={type:t.type,name:t.name,value:e,listener:i,options:n},r?r.push(o):this.__on=[o]}}function cr(t,e,n){var r=sr(t+""),o,i=r.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,u=a.length,l;c<u;++c)for(o=0,l=a[c];o<i;++o)if((s=r[o]).type===l.type&&s.name===l.name)return l.value}return}for(a=e?lr:ar,o=0;o<i;++o)this.each(a(r[o],e,n));return this}function _e(t,e,n){var r=pe(t),o=r.CustomEvent;typeof o=="function"?o=new o(e,n):(o=r.document.createEvent("Event"),n?(o.initEvent(e,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}function ur(t,e){return function(){return _e(this,t,e)}}function dr(t,e){return function(){return _e(this,t,e.apply(this,arguments))}}function fr(t,e){return this.each((typeof e=="function"?dr:ur)(t,e))}function*pr(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],o=0,i=r.length,s;o<i;++o)(s=r[o])&&(yield s)}var hr=[null];function U(t,e){this._groups=t,this._parents=e}function pt(){return new U([[document.documentElement]],hr)}function yr(){return this}U.prototype=pt.prototype={constructor:U,select:Ye,selectAll:Ue,selectChild:Je,selectChildren:Ze,filter:Ke,data:on,enter:Qe,exit:an,join:ln,merge:cn,selection:yr,order:un,sort:dn,call:pn,nodes:hn,node:yn,size:mn,empty:gn,each:_n,attr:An,style:Nn,property:Tn,classed:On,text:Xn,html:qn,raise:Jn,lower:Wn,append:jn,insert:Kn,remove:tr,clone:rr,datum:or,on:cr,dispatch:fr,[Symbol.iterator]:pr};function mr(t){return new U([[document.querySelector(t)]],[document.documentElement])}function Xt(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function xe(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function ht(){}var ct=.7,bt=1/ct,nt="\\s*([+-]?\\d+)\\s*",ut="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",J="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gr=/^#([0-9a-f]{3,8})$/,_r=new RegExp(`^rgb\\(${nt},${nt},${nt}\\)$`),xr=new RegExp(`^rgb\\(${J},${J},${J}\\)$`),vr=new RegExp(`^rgba\\(${nt},${nt},${nt},${ut}\\)$`),wr=new RegExp(`^rgba\\(${J},${J},${J},${ut}\\)$`),br=new RegExp(`^hsl\\(${ut},${J},${J}\\)$`),kr=new RegExp(`^hsla\\(${ut},${J},${J},${ut}\\)$`),Jt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Xt(ht,dt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Vt,formatHex:Vt,formatHex8:Er,formatHsl:Ar,formatRgb:Wt,toString:Wt});function Vt(){return this.rgb().formatHex()}function Er(){return this.rgb().formatHex8()}function Ar(){return ve(this).formatHsl()}function Wt(){return this.rgb().formatRgb()}function dt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=gr.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?jt(e):n===3?new X(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?yt(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?yt(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=_r.exec(t))?new X(e[1],e[2],e[3],1):(e=xr.exec(t))?new X(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=vr.exec(t))?yt(e[1],e[2],e[3],e[4]):(e=wr.exec(t))?yt(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=br.exec(t))?Qt(e[1],e[2]/100,e[3]/100,1):(e=kr.exec(t))?Qt(e[1],e[2]/100,e[3]/100,e[4]):Jt.hasOwnProperty(t)?jt(Jt[t]):t==="transparent"?new X(NaN,NaN,NaN,0):null}function jt(t){return new X(t>>16&255,t>>8&255,t&255,1)}function yt(t,e,n,r){return r<=0&&(t=e=n=NaN),new X(t,e,n,r)}function Ir(t){return t instanceof ht||(t=dt(t)),t?(t=t.rgb(),new X(t.r,t.g,t.b,t.opacity)):new X}function Tt(t,e,n,r){return arguments.length===1?Ir(t):new X(t,e,n,r??1)}function X(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Xt(X,Tt,xe(ht,{brighter(t){return t=t==null?bt:Math.pow(bt,t),new X(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?ct:Math.pow(ct,t),new X(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new X(tt(this.r),tt(this.g),tt(this.b),kt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Zt,formatHex:Zt,formatHex8:$r,formatRgb:Kt,toString:Kt}));function Zt(){return`#${Q(this.r)}${Q(this.g)}${Q(this.b)}`}function $r(){return`#${Q(this.r)}${Q(this.g)}${Q(this.b)}${Q((isNaN(this.opacity)?1:this.opacity)*255)}`}function Kt(){const t=kt(this.opacity);return`${t===1?"rgb(":"rgba("}${tt(this.r)}, ${tt(this.g)}, ${tt(this.b)}${t===1?")":`, ${t})`}`}function kt(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function tt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Q(t){return t=tt(t),(t<16?"0":"")+t.toString(16)}function Qt(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new q(t,e,n,r)}function ve(t){if(t instanceof q)return new q(t.h,t.s,t.l,t.opacity);if(t instanceof ht||(t=dt(t)),!t)return new q;if(t instanceof q)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,o=Math.min(e,n,r),i=Math.max(e,n,r),s=NaN,a=i-o,c=(i+o)/2;return a?(e===i?s=(n-r)/a+(n<r)*6:n===i?s=(r-e)/a+2:s=(e-n)/a+4,a/=c<.5?i+o:2-i-o,s*=60):a=c>0&&c<1?0:s,new q(s,a,c,t.opacity)}function Mr(t,e,n,r){return arguments.length===1?ve(t):new q(t,e,n,r??1)}function q(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Xt(q,Mr,xe(ht,{brighter(t){return t=t==null?bt:Math.pow(bt,t),new q(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?ct:Math.pow(ct,t),new q(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,o=2*n-r;return new X(St(t>=240?t-240:t+120,o,r),St(t,o,r),St(t<120?t+240:t-120,o,r),this.opacity)},clamp(){return new q(te(this.h),mt(this.s),mt(this.l),kt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=kt(this.opacity);return`${t===1?"hsl(":"hsla("}${te(this.h)}, ${mt(this.s)*100}%, ${mt(this.l)*100}%${t===1?")":`, ${t})`}`}}));function te(t){return t=(t||0)%360,t<0?t+360:t}function mt(t){return Math.max(0,Math.min(1,t||0))}function St(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const we=t=>()=>t;function Nr(t,e){return function(n){return t+n*e}}function Sr(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Br(t){return(t=+t)==1?be:function(e,n){return n-e?Sr(e,n,t):we(isNaN(e)?n:e)}}function be(t,e){var n=e-t;return n?Nr(t,n):we(isNaN(t)?e:t)}const ee=function t(e){var n=Br(e);function r(o,i){var s=n((o=Tt(o)).r,(i=Tt(i)).r),a=n(o.g,i.g),c=n(o.b,i.b),u=be(o.opacity,i.opacity);return function(l){return o.r=s(l),o.g=a(l),o.b=c(l),o.opacity=u(l),o+""}}return r.gamma=t,r}(1);function K(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var Lt=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Bt=new RegExp(Lt.source,"g");function Cr(t){return function(){return t}}function Tr(t){return function(e){return t(e)+""}}function Lr(t,e){var n=Lt.lastIndex=Bt.lastIndex=0,r,o,i,s=-1,a=[],c=[];for(t=t+"",e=e+"";(r=Lt.exec(t))&&(o=Bt.exec(e));)(i=o.index)>n&&(i=e.slice(n,i),a[s]?a[s]+=i:a[++s]=i),(r=r[0])===(o=o[0])?a[s]?a[s]+=o:a[++s]=o:(a[++s]=null,c.push({i:s,x:K(r,o)})),n=Bt.lastIndex;return n<e.length&&(i=e.slice(n),a[s]?a[s]+=i:a[++s]=i),a.length<2?c[0]?Tr(c[0].x):Cr(e):(e=c.length,function(u){for(var l=0,f;l<e;++l)a[(f=c[l]).i]=f.x(u);return a.join("")})}var ne=180/Math.PI,Rt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ke(t,e,n,r,o,i){var s,a,c;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,c/=a),t*r<e*n&&(t=-t,e=-e,c=-c,s=-s),{translateX:o,translateY:i,rotate:Math.atan2(e,t)*ne,skewX:Math.atan(c)*ne,scaleX:s,scaleY:a}}var gt;function Rr(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Rt:ke(e.a,e.b,e.c,e.d,e.e,e.f)}function zr(t){return t==null||(gt||(gt=document.createElementNS("http://www.w3.org/2000/svg","g")),gt.setAttribute("transform",t),!(t=gt.transform.baseVal.consolidate()))?Rt:(t=t.matrix,ke(t.a,t.b,t.c,t.d,t.e,t.f))}function Ee(t,e,n,r){function o(u){return u.length?u.pop()+" ":""}function i(u,l,f,p,y,v){if(u!==f||l!==p){var h=y.push("translate(",null,e,null,n);v.push({i:h-4,x:K(u,f)},{i:h-2,x:K(l,p)})}else(f||p)&&y.push("translate("+f+e+p+n)}function s(u,l,f,p){u!==l?(u-l>180?l+=360:l-u>180&&(u+=360),p.push({i:f.push(o(f)+"rotate(",null,r)-2,x:K(u,l)})):l&&f.push(o(f)+"rotate("+l+r)}function a(u,l,f,p){u!==l?p.push({i:f.push(o(f)+"skewX(",null,r)-2,x:K(u,l)}):l&&f.push(o(f)+"skewX("+l+r)}function c(u,l,f,p,y,v){if(u!==f||l!==p){var h=y.push(o(y)+"scale(",null,",",null,")");v.push({i:h-4,x:K(u,f)},{i:h-2,x:K(l,p)})}else(f!==1||p!==1)&&y.push(o(y)+"scale("+f+","+p+")")}return function(u,l){var f=[],p=[];return u=t(u),l=t(l),i(u.translateX,u.translateY,l.translateX,l.translateY,f,p),s(u.rotate,l.rotate,f,p),a(u.skewX,l.skewX,f,p),c(u.scaleX,u.scaleY,l.scaleX,l.scaleY,f,p),u=l=null,function(y){for(var v=-1,h=p.length,_;++v<h;)f[(_=p[v]).i]=_.x(y);return f.join("")}}}var Or=Ee(Rr,"px, ","px)","deg)"),Dr=Ee(zr,", ",")",")"),ot=0,st=0,it=0,Ae=1e3,Et,at,At=0,et=0,Mt=0,ft=typeof performance=="object"&&performance.now?performance:Date,Ie=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Ft(){return et||(Ie(Yr),et=ft.now()+Mt)}function Yr(){et=0}function It(){this._call=this._time=this._next=null}It.prototype=$e.prototype={constructor:It,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Ft():+n)+(e==null?0:+e),!this._next&&at!==this&&(at?at._next=this:Et=this,at=this),this._call=t,this._time=n,zt()},stop:function(){this._call&&(this._call=null,this._time=1/0,zt())}};function $e(t,e,n){var r=new It;return r.restart(t,e,n),r}function Pr(){Ft(),++ot;for(var t=Et,e;t;)(e=et-t._time)>=0&&t._call.call(void 0,e),t=t._next;--ot}function re(){et=(At=ft.now())+Mt,ot=st=0;try{Pr()}finally{ot=0,Fr(),et=0}}function Xr(){var t=ft.now(),e=t-At;e>Ae&&(Mt-=e,At=t)}function Fr(){for(var t,e=Et,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Et=n);at=t,zt(r)}function zt(t){if(!ot){st&&(st=clearTimeout(st));var e=t-et;e>24?(t<1/0&&(st=setTimeout(re,t-ft.now()-Mt)),it&&(it=clearInterval(it))):(it||(At=ft.now(),it=setInterval(Xr,Ae)),ot=1,Ie(re))}}function oe(t,e,n){var r=new It;return e=e==null?0:+e,r.restart(o=>{r.stop(),t(o+e)},e,n),r}var Ur=ae("start","end","cancel","interrupt"),Hr=[],Me=0,ie=1,Ot=2,xt=3,se=4,Dt=5,vt=6;function Nt(t,e,n,r,o,i){var s=t.__transition;if(!s)t.__transition={};else if(n in s)return;qr(t,n,{name:e,index:r,group:o,on:Ur,tween:Hr,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Me})}function Ut(t,e){var n=G(t,e);if(n.state>Me)throw new Error("too late; already scheduled");return n}function V(t,e){var n=G(t,e);if(n.state>xt)throw new Error("too late; already running");return n}function G(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function qr(t,e,n){var r=t.__transition,o;r[e]=n,n.timer=$e(i,0,n.time);function i(u){n.state=ie,n.timer.restart(s,n.delay,n.time),n.delay<=u&&s(u-n.delay)}function s(u){var l,f,p,y;if(n.state!==ie)return c();for(l in r)if(y=r[l],y.name===n.name){if(y.state===xt)return oe(s);y.state===se?(y.state=vt,y.timer.stop(),y.on.call("interrupt",t,t.__data__,y.index,y.group),delete r[l]):+l<e&&(y.state=vt,y.timer.stop(),y.on.call("cancel",t,t.__data__,y.index,y.group),delete r[l])}if(oe(function(){n.state===xt&&(n.state=se,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=Ot,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Ot){for(n.state=xt,o=new Array(p=n.tween.length),l=0,f=-1;l<p;++l)(y=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(o[++f]=y);o.length=f+1}}function a(u){for(var l=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=Dt,1),f=-1,p=o.length;++f<p;)o[f].call(t,l);n.state===Dt&&(n.on.call("end",t,t.__data__,n.index,n.group),c())}function c(){n.state=vt,n.timer.stop(),delete r[e];for(var u in r)return;delete t.__transition}}function Gr(t,e){var n=t.__transition,r,o,i=!0,s;if(n){e=e==null?null:e+"";for(s in n){if((r=n[s]).name!==e){i=!1;continue}o=r.state>Ot&&r.state<Dt,r.state=vt,r.timer.stop(),r.on.call(o?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[s]}i&&delete t.__transition}}function Jr(t){return this.each(function(){Gr(this,t)})}function Vr(t,e){var n,r;return function(){var o=V(this,t),i=o.tween;if(i!==n){r=n=i;for(var s=0,a=r.length;s<a;++s)if(r[s].name===e){r=r.slice(),r.splice(s,1);break}}o.tween=r}}function Wr(t,e,n){var r,o;if(typeof n!="function")throw new Error;return function(){var i=V(this,t),s=i.tween;if(s!==r){o=(r=s).slice();for(var a={name:e,value:n},c=0,u=o.length;c<u;++c)if(o[c].name===e){o[c]=a;break}c===u&&o.push(a)}i.tween=o}}function jr(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=G(this.node(),n).tween,o=0,i=r.length,s;o<i;++o)if((s=r[o]).name===t)return s.value;return null}return this.each((e==null?Vr:Wr)(n,t,e))}function Ht(t,e,n){var r=t._id;return t.each(function(){var o=V(this,r);(o.value||(o.value={}))[e]=n.apply(this,arguments)}),function(o){return G(o,r).value[e]}}function Ne(t,e){var n;return(typeof e=="number"?K:e instanceof dt?ee:(n=dt(e))?(e=n,ee):Lr)(t,e)}function Zr(t){return function(){this.removeAttribute(t)}}function Kr(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Qr(t,e,n){var r,o=n+"",i;return function(){var s=this.getAttribute(t);return s===o?null:s===r?i:i=e(r=s,n)}}function to(t,e,n){var r,o=n+"",i;return function(){var s=this.getAttributeNS(t.space,t.local);return s===o?null:s===r?i:i=e(r=s,n)}}function eo(t,e,n){var r,o,i;return function(){var s,a=n(this),c;return a==null?void this.removeAttribute(t):(s=this.getAttribute(t),c=a+"",s===c?null:s===r&&c===o?i:(o=c,i=e(r=s,a)))}}function no(t,e,n){var r,o,i;return function(){var s,a=n(this),c;return a==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),c=a+"",s===c?null:s===r&&c===o?i:(o=c,i=e(r=s,a)))}}function ro(t,e){var n=$t(t),r=n==="transform"?Dr:Ne;return this.attrTween(t,typeof e=="function"?(n.local?no:eo)(n,r,Ht(this,"attr."+t,e)):e==null?(n.local?Kr:Zr)(n):(n.local?to:Qr)(n,r,e))}function oo(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function io(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function so(t,e){var n,r;function o(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&io(t,i)),n}return o._value=e,o}function ao(t,e){var n,r;function o(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&oo(t,i)),n}return o._value=e,o}function lo(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=$t(t);return this.tween(n,(r.local?so:ao)(r,e))}function co(t,e){return function(){Ut(this,t).delay=+e.apply(this,arguments)}}function uo(t,e){return e=+e,function(){Ut(this,t).delay=e}}function fo(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?co:uo)(e,t)):G(this.node(),e).delay}function po(t,e){return function(){V(this,t).duration=+e.apply(this,arguments)}}function ho(t,e){return e=+e,function(){V(this,t).duration=e}}function yo(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?po:ho)(e,t)):G(this.node(),e).duration}function mo(t,e){if(typeof e!="function")throw new Error;return function(){V(this,t).ease=e}}function go(t){var e=this._id;return arguments.length?this.each(mo(e,t)):G(this.node(),e).ease}function _o(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;V(this,t).ease=n}}function xo(t){if(typeof t!="function")throw new Error;return this.each(_o(this._id,t))}function vo(t){typeof t!="function"&&(t=ue(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i=e[o],s=i.length,a=r[o]=[],c,u=0;u<s;++u)(c=i[u])&&t.call(c,c.__data__,u,i)&&a.push(c);return new Z(r,this._parents,this._name,this._id)}function wo(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,o=n.length,i=Math.min(r,o),s=new Array(r),a=0;a<i;++a)for(var c=e[a],u=n[a],l=c.length,f=s[a]=new Array(l),p,y=0;y<l;++y)(p=c[y]||u[y])&&(f[y]=p);for(;a<r;++a)s[a]=e[a];return new Z(s,this._parents,this._name,this._id)}function bo(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function ko(t,e,n){var r,o,i=bo(e)?Ut:V;return function(){var s=i(this,t),a=s.on;a!==r&&(o=(r=a).copy()).on(e,n),s.on=o}}function Eo(t,e){var n=this._id;return arguments.length<2?G(this.node(),n).on.on(t):this.each(ko(n,t,e))}function Ao(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Io(){return this.on("end.remove",Ao(this._id))}function $o(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Yt(t));for(var r=this._groups,o=r.length,i=new Array(o),s=0;s<o;++s)for(var a=r[s],c=a.length,u=i[s]=new Array(c),l,f,p=0;p<c;++p)(l=a[p])&&(f=t.call(l,l.__data__,p,a))&&("__data__"in l&&(f.__data__=l.__data__),u[p]=f,Nt(u[p],e,n,p,u,G(l,n)));return new Z(i,this._parents,e,n)}function Mo(t){var e=this._name,n=this._id;typeof t!="function"&&(t=ce(t));for(var r=this._groups,o=r.length,i=[],s=[],a=0;a<o;++a)for(var c=r[a],u=c.length,l,f=0;f<u;++f)if(l=c[f]){for(var p=t.call(l,l.__data__,f,c),y,v=G(l,n),h=0,_=p.length;h<_;++h)(y=p[h])&&Nt(y,e,n,h,p,v);i.push(p),s.push(l)}return new Z(i,s,e,n)}var No=pt.prototype.constructor;function So(){return new No(this._groups,this._parents)}function Bo(t,e){var n,r,o;return function(){var i=rt(this,t),s=(this.style.removeProperty(t),rt(this,t));return i===s?null:i===n&&s===r?o:o=e(n=i,r=s)}}function Se(t){return function(){this.style.removeProperty(t)}}function Co(t,e,n){var r,o=n+"",i;return function(){var s=rt(this,t);return s===o?null:s===r?i:i=e(r=s,n)}}function To(t,e,n){var r,o,i;return function(){var s=rt(this,t),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(t),rt(this,t))),s===c?null:s===r&&c===o?i:(o=c,i=e(r=s,a))}}function Lo(t,e){var n,r,o,i="style."+e,s="end."+i,a;return function(){var c=V(this,t),u=c.on,l=c.value[i]==null?a||(a=Se(e)):void 0;(u!==n||o!==l)&&(r=(n=u).copy()).on(s,o=l),c.on=r}}function Ro(t,e,n){var r=(t+="")=="transform"?Or:Ne;return e==null?this.styleTween(t,Bo(t,r)).on("end.style."+t,Se(t)):typeof e=="function"?this.styleTween(t,To(t,r,Ht(this,"style."+t,e))).each(Lo(this._id,t)):this.styleTween(t,Co(t,r,e),n).on("end.style."+t,null)}function zo(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Oo(t,e,n){var r,o;function i(){var s=e.apply(this,arguments);return s!==o&&(r=(o=s)&&zo(t,s,n)),r}return i._value=e,i}function Do(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,Oo(t,e,n??""))}function Yo(t){return function(){this.textContent=t}}function Po(t){return function(){var e=t(this);this.textContent=e??""}}function Xo(t){return this.tween("text",typeof t=="function"?Po(Ht(this,"text",t)):Yo(t==null?"":t+""))}function Fo(t){return function(e){this.textContent=t.call(this,e)}}function Uo(t){var e,n;function r(){var o=t.apply(this,arguments);return o!==n&&(e=(n=o)&&Fo(o)),e}return r._value=t,r}function Ho(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Uo(t))}function qo(){for(var t=this._name,e=this._id,n=Be(),r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,c,u=0;u<a;++u)if(c=s[u]){var l=G(c,e);Nt(c,t,n,u,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new Z(r,this._parents,t,n)}function Go(){var t,e,n=this,r=n._id,o=n.size();return new Promise(function(i,s){var a={value:s},c={value:function(){--o===0&&i()}};n.each(function(){var u=V(this,r),l=u.on;l!==t&&(e=(t=l).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(c)),u.on=e}),o===0&&i()})}var Jo=0;function Z(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Be(){return++Jo}var j=pt.prototype;Z.prototype={constructor:Z,select:$o,selectAll:Mo,selectChild:j.selectChild,selectChildren:j.selectChildren,filter:vo,merge:wo,selection:So,transition:qo,call:j.call,nodes:j.nodes,node:j.node,size:j.size,empty:j.empty,each:j.each,on:Eo,attr:ro,attrTween:lo,style:Ro,styleTween:Do,text:Xo,textTween:Ho,remove:Io,tween:jr,delay:fo,duration:yo,ease:go,easeVarying:xo,end:Go,[Symbol.iterator]:j[Symbol.iterator]};function Vo(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Wo={time:null,delay:0,duration:250,ease:Vo};function jo(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Zo(t){var e,n;t instanceof Z?(e=t._id,t=t._name):(e=Be(),(n=Wo).time=Ft(),t=t==null?null:t+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,c,u=0;u<a;++u)(c=s[u])&&Nt(c,t,e,u,s,n||jo(c,e));return new Z(r,this._parents,t,e)}pt.prototype.interrupt=Jr;pt.prototype.transition=Zo;function lt(t,e,n){this.k=t,this.x=e,this.y=n}lt.prototype={constructor:lt,scale:function(t){return t===1?this:new lt(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new lt(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};lt.prototype;function Ko(t,e){}window.plot_map=Qo;window.plot_pixels=ti;window.updateData=Ko;function Qo(t,e){const n=document.getElementById(e),r=t.getContext("2d");t.width=n.offsetWidth,t.height=n.offsetHeight-100;const o=d3.select("body").append("div").style("position","absolute").style("background","white").style("padding","5px 10px").style("border","1px solid black").style("border-radius","5px").style("font-size","14px").style("pointer-events","none").style("opacity",0);Promise.all([d3.json("./map_geojsons/us_states.geojson"),d3.json("./map_geojsons/states.geojson")]).then(([i,s])=>{const a={type:"FeatureCollection",features:i.features.concat(s.features)},c=d3.geoAlbers().fitSize([t.width,t.height],a),u=d3.geoPath().projection(c);r.clearRect(0,0,t.width,t.height),r.fillStyle="white",r.strokeStyle="black",r.lineWidth=1,a.features.forEach(y=>{const v=u(y);r.beginPath();const h=new Path2D(v);r.fill(h),r.stroke(h)});const l=[-112.2146,40.7],[f,p]=c(l);r.font="30px sans-serif",r.fillStyle="gold",r.textAlign="center",r.textBaseline="middle",r.fillText("★",f,p),t.addEventListener("mousemove",function(y){const v=d3.pointer(y);Math.sqrt(Math.pow(v[0]-f,2)+Math.pow(v[1]-p,2))<15?o.style("opacity",1).html("Great Salt Lake!").style("left",y.pageX+10+"px").style("top",y.pageY-20+"px"):o.style("opacity",0)})}).catch(i=>{console.error("Error loading map background files: ",i)})}function ti(t,e,n,r,o,i,s,a,c,u,l,f){const p=document.getElementById(n);p.style.justifyContent="",d3.select("#great-salt-lake-star").style("visibility","hidden");const y=document.getElementById(r),v=document.getElementById(i),h=document.getElementById(a),_=t.getContext("2d");t.width=p.offsetWidth,t.height=p.offsetHeight-y.offsetHeight-25;let T=null,d=null;function m(){_.fillStyle="white",_.strokeStyle="black",_.lineWidth=1,_.globalAlpha=1,d=d3.geoAlbers().fitSize([t.width,t.height],T);const E=d3.geoPath().projection(d);T&&T.features.forEach(I=>{const B=E(I);_.beginPath();const z=new Path2D(B);_.fill(z),_.stroke(z)})}Promise.all([d3.json("./map_geojsons/us_states.geojson"),d3.json("./map_geojsons/states.geojson")]).then(([E,I])=>{T={type:"FeatureCollection",features:E.features.concat(I.features)},d3.select("#great-salt-lake-star").style("visibility","hidden"),_.clearRect(0,0,t.width,t.height),m()}).catch(E=>{console.error("Error loading map background files: ",E)});const g=document.getElementById(o),x=document.getElementById(s),$=document.getElementById(c),b=document.getElementById(u),A=["January","February","March","April","May","June","July","August","September","October","November","December"],S=d3.select(f);S.select("circle").empty()&&S.append("circle").attr("r",10).attr("cx",15).attr("cy",15).attr("fill","lightgray").attr("stroke","black"),S.select("text").empty()&&S.append("text").attr("x",11).attr("y",19).attr("font-size","14px").attr("font-weight","bold").attr("fill","black").text("?"),d3.select("body").select(".info-tooltip").empty()&&d3.select("body").append("div").attr("class","info-tooltip").style("position","absolute").style("background","white").style("border","1px solid black").style("padding","5px").style("border-radius","3px").style("box-shadow","1px 1px 3px rgba(0,0,0,0.3)").style("font-size","10px").style("max-width","250px").style("display","none").html("<strong>What does this map show?</strong><br>This map visualizes bird observations over the past 20 years, animating each month to reveal the migration and movement dynamics of the chosen species between their two primary hubs: Utah and Mexico. The animation is powered by observation data from eBird, a global citizen science platform that collects bird sightings from volunteers. <br><br> While the data shows an overall increase in observations over time, this trend is influenced by the growing number of birders contributing to eBird rather than a direct reflection of rising bird populations. As you continue through this story, we’ll explore what’s truly happening between seasons and how climate and habitat changes are shaping these migratory patterns. <br><br> Once the animation concludes, you can update the data to reflect your own curiosity—allowing you to explore different time periods or patterns that stand out to you.");const k=d3.select(".info-tooltip");S.on("mouseover",function(E){k.style("left",`${E.pageX-200}px`).style("top",`${E.pageY-350}px`).style("display","block")}),S.on("mouseout",function(){k.style("display","none")});const M=2004,C=2023;v.min=M,v.max=C,v.value=M,v.disabled=!0,h.min=0,h.max=11,h.step=1,h.value=0,h.disabled=!0;function L(){const E=v.value,I=h.value;g.textContent=`${E}`,x.textContent=A[I]}for(let E=M;E<=C;E++){const I=document.createElement("div");I.style.position="absolute",I.style.left=`calc(${(E-M)/(C-M)*100}% - 0.5px)`,I.style.height="10px",I.style.width="2px",I.style.backgroundColor="black";const B=document.createElement("span");B.textContent=E,B.style.position="absolute",B.style.top="15px",B.style.right="-12px",B.style.fontSize="10px",B.style.color="black",I.appendChild(B),$.appendChild(I)}for(let E=0;E<12;E++){const I=document.createElement("div");I.style.position="absolute",I.style.left=`${E/12*100}%`,I.style.height="10px",I.style.width="2px",I.style.backgroundColor="black";const B=document.createElement("span");B.textContent=A[E],B.style.position="absolute",B.style.top="15px",B.style.right="-12px",B.style.fontSize="10px",B.style.color="black",I.appendChild(B),b.appendChild(I)}L();function N(E,I){g.textContent=`${E}`,x.textContent=A[I];const B=String(I+1).padStart(2,"0"),z=`${E}-${B}`;let O={};Promise.all([d3.json(e[z].MX).then(w=>{O[z]=O[z]||{},O[z].MX=w.features}),d3.json(e[z].UT).then(w=>{O[z]=O[z]||{},O[z].UT=w.features}),d3.json(e[z].AZ).then(w=>{O[z]=O[z]||{},O[z].AZ=w.features})]).then(()=>{const w=O[z]||{},D=w.MX||[],Y=w.UT||[],F=w.AZ||[];d3.select("#great-salt-lake-star").style("visibility","hidden"),_.clearRect(0,0,t.width,t.height),m(),_.globalAlpha=.1,Array.isArray(D)&&D.forEach(P=>{const[W,H]=d(P.geometry.coordinates);_.beginPath(),_.arc(W,H,1.5,0,2*Math.PI),_.fillStyle="blue",_.fill(),_.globalAlpha=.1}),Array.isArray(Y)&&Y.forEach(P=>{const[W,H]=d(P.geometry.coordinates);_.beginPath(),_.arc(W,H,1.5,0,2*Math.PI),_.fillStyle="blue",_.fill(),_.globalAlpha=.1}),Array.isArray(F)&&F.forEach(P=>{const[W,H]=d(P.geometry.coordinates);_.beginPath(),_.arc(W,H,1.5,0,2*Math.PI),_.fillStyle="blue",_.fill(),_.globalAlpha=.1}),_.globalAlpha=.1}).catch(w=>console.error("Error loading JSON data:",w))}R(l),document.getElementById("map_button").addEventListener("click",function(){R(l)});function R(E){clearTimeout(E.timeoutId);let I=M,B=0;const z=50;let O=!1;v.disabled=!0,h.disabled=!0,v.style.opacity=.5,h.style.opacity=.5,E.animationRunning=!0,v.addEventListener("input",()=>{O=!0,L(),N(parseInt(v.value),parseInt(h.value))}),h.addEventListener("input",()=>{O=!0,L(),N(parseInt(v.value),parseInt(h.value))});function w(){O||!E.animationRunning||(N(I,B),v.value=I,h.value=B,B+=2,B===12&&(B=0,I++),I<=C?E.timeoutId=setTimeout(w,z):(E.animationRunning=!1,v.disabled=!1,h.disabled=!1,v.style.opacity=1,h.style.opacity=1))}E.timeoutId=setTimeout(w,z)}return{updateData:N,animationState:l}}window.climate_map=ei;function ei(t,e,n){const s=d3.select(t);a(900,900,80,s);async function a(c,u,l,f){const v=(await(await fetch("./climate_data/oni_data.txt")).text()).trim().split(`
`),h=[];v.forEach(w=>{const D=w.trim().split(/\s+/),Y=+D.shift();D.forEach((F,P)=>{h.push({date:new Date(Y,P),value:parseFloat(F)})})});const d=(await(await fetch("./climate_data/sst_data.txt")).text()).trim().split(`
`),m=[];d.forEach(w=>{const D=w.trim().split(/\s+/),Y=parseInt(D[0]),F=parseInt(D[1]),P=parseFloat(D[5]);Y>=2004&&Y<=2024&&F===1&&m.push({date:new Date(Y,0),value:P})});const g=d3.scaleTime().domain(d3.extent(h,w=>w.date)).range([l,c-l]),x=d3.scaleLinear().domain([d3.min(h,w=>w.value),d3.max(h,w=>w.value)]).range([u-l,l]),$=d3.scaleLinear().domain([d3.min(m,w=>w.value),d3.max(m,w=>w.value)]).range([u-l,l]),b=d3.line().x(w=>g(w.date)).y(w=>x(w.value)).curve(d3.curveMonotoneX),A=d3.line().x(w=>g(w.date)).y(w=>$(w.value)).curve(d3.curveMonotoneX),S=d3.area().x(w=>g(w.date)).y0(w=>x(0)).y1(w=>x(w.value)).curve(d3.curveMonotoneX),k=d3.max([...h,...m],w=>Math.abs(w.value)),M=f.append("defs"),C=M.append("linearGradient").attr("id","oniGradient").attr("gradientUnits","userSpaceOnUse").attr("x1","0%").attr("x2","0%").attr("y1",x(k)).attr("y2",x(-k));C.append("stop").attr("offset","0%").attr("stop-color",d3.interpolateReds(1)),C.append("stop").attr("offset","50%").attr("stop-color",d3.interpolateBlues(.1)),C.append("stop").attr("offset","100%").attr("stop-color",d3.interpolateBlues(1)),f.append("path").datum(h).attr("fill","url(#oniGradient)").attr("d",S).on("mousemove",B).on("mouseleave",z).on("click",O),f.append("path").datum(m).attr("fill","none").attr("stroke","orange").attr("stroke-width",4).attr("d",A).style("pointer-events","visibleStroke").on("mousemove",B).on("mouseleave",z).on("click",O),f.append("path").datum(h).attr("fill","none").attr("stroke","black").attr("stroke-width",2).attr("d",b).style("pointer-events","visibleStroke").on("mousemove",B).on("mouseleave",z).on("click",O),f.append("line").attr("x1",l).attr("x2",c-l).attr("y1",x(0)).attr("y2",x(0)).attr("stroke","gray").attr("stroke-width",1).attr("stroke-dasharray","4 2"),f.append("g").attr("transform",`translate(0,${u-l})`).call(d3.axisBottom(g).ticks(10)),f.append("g").attr("transform",`translate(${l},0)`).call(d3.axisLeft(x)),f.append("g").attr("transform",`translate(${c-l},0)`).attr("class","sst-axis").call(d3.axisRight($)),f.append("text").attr("x",c/2).attr("y",l/2).attr("text-anchor","middle").style("font-size","24px").style("font-weight","bold").text("ONI Index & NINO3 January Temperatures"),f.append("text").attr("x",c/2).attr("y",u-l/3).attr("text-anchor","middle").style("font-size","20px").text("Year"),f.append("text").attr("transform","rotate(-90)").attr("x",-900/2).attr("y",l/3).attr("text-anchor","middle").style("font-size","20px").text("ONI Index"),f.append("text").attr("transform","rotate(-90)").attr("x",-900/2).attr("y",c-l/3).attr("text-anchor","middle").style("font-size","20px").text("Nino3 Temperature Index"),f.append("line").attr("x1",c-l).attr("x2",c-l).attr("y1",l).attr("y2",u-l).attr("stroke","black").attr("stroke-width",1);const L=f.append("g").attr("transform",`translate(${c-l-40}, ${l-60})`).style("cursor","pointer");L.append("circle").attr("r",20).attr("fill","lightgray").attr("stroke","black"),L.append("text").attr("x",-5).attr("y",6).attr("font-size","24px").attr("font-weight","bold").attr("fill","black").text("?");const N=d3.select("body").append("div").style("position","absolute").style("background","white").style("border","1px solid black").style("padding","5px").style("border-radius","3px").style("box-shadow","1px 1px 3px rgba(0,0,0,0.3)").style("font-size","10px").style("max-width","250px").style("display","none").html("<strong>What does this graph show?</strong><br>This graph displays the ONI Index, along with the NINO3 temperature variations over time, taken from January of each year.<br><br> The ONI index is a primary indicator for monitoring El Niño and La Niña. The ONI Index is calculated by averaging the difference between the current sea surface temperature and the long-term average sea surface temperature. <br><br> The Nino3 temperature index measures sea surface temperature anomalies in the eastern Pacific Ocean (where Mexico lies). Understanding the change in sea surface temperature helps further explain the intensity of an El Niño and/or La Niña event. <br><br> This graph syncs with the observation map and updates as you explore different climate events. ");L.on("mouseover",function(w){N.style("left",`${w.pageX+10}px`).style("top",`${w.pageY-25}px`).style("display","block")}),L.on("mouseout",function(){N.style("display","none")});const R=f.append("g").attr("transform",`translate(${l+20}, ${l-20})`);R.append("circle").attr("cx",10).attr("cy",10).attr("r",6).attr("fill","orange"),R.append("text").attr("x",20).attr("y",14).style("font-size","14px").attr("fill","black").text("NINO3 Temperature"),E(f,M);function E(w,D){const H=D.append("linearGradient").attr("id","legendGradient").attr("x1","0%").attr("x2","0%").attr("y1","0%").attr("y2","100%");H.append("stop").attr("offset","0%").attr("stop-color",d3.interpolateReds(1)),H.append("stop").attr("offset","50%").attr("stop-color",d3.interpolateReds(0)),H.append("stop").attr("offset","100%").attr("stop-color",d3.interpolateBlues(1)),w.append("rect").attr("x",750).attr("y",80).attr("width",20).attr("height",200).style("fill","url(#legendGradient)"),w.append("text").attr("x",750+20/2).attr("y",70).style("font-size","12px").style("text-anchor","middle").text("Strong El Niño"),w.append("text").attr("x",750+20/2).attr("y",300).style("font-size","12px").style("text-anchor","middle").text("Strong La Niña")}const I=d3.select("body").append("div").attr("id","graph-hover-tip").style("position","absolute").style("background","rgba(0, 0, 0, 0.7)").style("color","#fff").style("padding","6px 10px").style("border-radius","4px").style("pointer-events","none").style("font-size","12px").style("display","none").text("Click to select a month");function B(w){const[D,Y]=d3.pointer(w);if(D>=l&&D<=c-l&&Y>=l&&Y<=u-l){const{animationState:F}=window.pelicanUpdateController,P=F.animationRunning?"Wait for animation to finish":"Click to update data";I.text(P).style("left",`${w.pageX+10}px`).style("top",`${w.pageY-20}px`).style("display","block")}else I.style("display","none")}function z(){I.style("display","none")}function O(w){const[D,Y]=d3.pointer(w);if(D<l||D>c-l||Y<l||Y>u-l)return;const F=g.invert(D),P=F.getFullYear(),W=F.getMonth(),{updateData:H,animationState:Ce}=window.pelicanUpdateController;Ce.animationRunning||(document.getElementById(e).value=P,document.getElementById(n).value=W,H(P,W))}}}window.plot_gsl_elevation=ni;function ni(t,e,n){const r=d3.select(t);async function o(){const s=(await d3.text("./climate_data/processed_gsl_elevation_data.txt")).trim().split(`
`).map(d=>{const[m,g]=d.split("	").map(x=>+x);return{year:m,value:g}}),a={top:60,right:30,bottom:60,left:80},c=600-a.left-a.right,u=300-a.top-a.bottom,l=d3.scaleLinear().domain(d3.extent(s,d=>d.year)).range([0,c]),f=d3.scaleLinear().domain([d3.min(s,d=>d.value)-1,d3.max(s,d=>d.value)+1]).range([u,0]),p=r.attr("viewBox",`0 0 ${c+a.left+a.right} ${u+a.top+a.bottom}`).append("g").attr("transform",`translate(${a.left},${a.top})`);p.append("g").attr("transform",`translate(0,${u})`).call(d3.axisBottom(l).tickFormat(d3.format("d"))),p.append("text").attr("x",c/2).attr("y",u+45).attr("text-anchor","middle").style("font-size","14px").text("Year"),p.append("g").call(d3.axisLeft(f)),p.append("text").attr("transform","rotate(-90)").attr("x",-180/2).attr("y",-60).attr("text-anchor","middle").style("font-size","14px").text("Elevation (ft)"),p.append("text").attr("x",c/2).attr("y",-30).attr("text-anchor","middle").style("font-size","18px").style("font-weight","bold").text("GSL Elevation Over Time");const y=d3.line().x(d=>l(d.year)).y(d=>f(d.value)).curve(d3.curveMonotoneX);p.append("path").datum(s).attr("fill","none").attr("stroke","steelblue").attr("stroke-width",2).attr("d",y);const v=p.append("circle").attr("r",4).attr("fill","red").style("display","none");r.on("mousemove",function(d){const[m]=d3.pointer(d),g=m-a.left;if(g<0||g>l.range()[1]){v.style("display","none");return}const x=l.invert(g);let $=0;for(;$<s.length-1&&s[$+1].year<x;)$++;const b=s[$],A=s[$+1];if(!b||!A){v.style("display","none");return}const S=(x-b.year)/(A.year-b.year),k=b.value+S*(A.value-b.value),M=l(x),C=f(k);v.attr("cx",M).attr("cy",C).style("display","block")});const h=d3.select("body").append("div").attr("id","graph-hover-tip").style("position","absolute").style("background","rgba(0, 0, 0, 0.7)").style("color","#fff").style("padding","6px 10px").style("border-radius","4px").style("pointer-events","none").style("font-size","12px").style("display","none");p.on("mousemove",function(d){const[m,g]=d3.pointer(d);if(m>=l.range()[0]&&m<=l.range()[1]){const{animationState:x}=window.pelicanUpdateController,$=x.animationRunning?"Wait for animation to finish":"Click to update data";h.text($).style("left",`${d.pageX+10}px`).style("top",`${d.pageY-20}px`).style("display","block")}else h.style("display","none")}).on("mouseleave",function(){h.style("display","none")}).on("click",function(d){const[m,g]=d3.pointer(d);if(m<l.range()[0]||m>l.range()[1])return;const x=l.invert(m),$=Math.floor(x),b=Math.floor(x%1*12),{updateData:A,animationState:S}=window.pelicanUpdateController;S.animationRunning||(document.getElementById(e).value=$,document.getElementById(n).value=b,A($,b))});const _=r.append("g").attr("transform",`translate(${c+a.left-10}, ${a.top-30})`).style("cursor","pointer");_.append("circle").attr("r",10).attr("fill","lightgray").attr("stroke","black"),_.append("text").attr("x",-5).attr("y",6).attr("font-size","19px").attr("font-weight","bold").attr("fill","black").text("?");const T=d3.select("body").append("div").style("position","absolute").style("background","white").style("border","1px solid black").style("padding","5px").style("border-radius","3px").style("box-shadow","1px 1px 3px rgba(0,0,0,0.3)").style("font-size","10px").style("max-width","200px").style("display","none").html("<strong>What does this graph show?</strong><br>This graph displays changes in elevation at the Great Salt Lake over time.<br><br> This graph syncs with the observation map and updates as you explore different elevation levels.");_.on("mouseover",function(d){T.style("left",`${d.pageX+10}px`).style("top",`${d.pageY+10}px`).style("display","block")}),_.on("mouseout",function(){T.style("display","none")})}o()}window.plot_gsl_birds=ri;window.plot_gsl_comparisons=ii;window.plot_gsl_comparisons_fixed_years=oi;async function ri(t,e){const o={top:50,right:80,bottom:80,left:80},i=d3.select(t),c=(await(await fetch(e)).json()).features||[],u=new Map;c.forEach(k=>{var E,I;const M=(E=k.properties)==null?void 0:E.observation_date,C=parseInt(((I=k.properties)==null?void 0:I.species_reported)||"0",10);if(!M||isNaN(C))return;const L=new Date(M),N=`${L.getFullYear()}-${String(L.getMonth()+1).padStart(2,"0")}`;u.has(N)||u.set(N,{totalSpecies:0,count:0});const R=u.get(N);R.totalSpecies+=C,R.count+=1});const l=Array.from(u.keys()).sort(),f=l.map(k=>{const M=u.get(k);return M.totalSpecies/M.count}),p=d3.max(f)||1,y=f.map(k=>k/p),v=l.map(k=>new Date(k+"-01")),h=new Date("2004-01-01"),_=d3.max(v),T=v.map((k,M)=>({date:k,value:y[M]})).filter(k=>k.date>=h),d=d3.scaleTime().domain([h,_]).range([o.left,900-o.right]),m=d3.scaleLinear().domain([0,1]).range([500-o.bottom,o.top]),g=d3.axisBottom(d).ticks(d3.timeYear.every(1)).tickFormat(d3.timeFormat("%Y-%m")),x=d3.axisBottom(d).ticks(d3.timeMonth.every(1)).tickSize(5).tickFormat(""),$=d3.axisLeft(m).ticks(5),b=30,A=T.map((k,M,C)=>{const L=Math.floor(b/2),N=Math.max(0,M-L),R=Math.min(C.length,M+L+1),E=C.slice(N,R),I=d3.mean(E,B=>B.value);return{date:k.date,value:I}});i.append("path").datum(A).attr("fill","none").attr("stroke","red").attr("stroke-width",2).attr("d",d3.line().x(k=>d(k.date)).y(k=>m(k.value)).curve(d3.curveMonotoneX)),i.append("g").attr("transform",`translate(0, ${500-o.bottom})`).call(x).selectAll("line").style("stroke","light-grey"),i.append("g").attr("transform",`translate(0, ${500-o.bottom})`).call(g).selectAll("text").attr("transform","rotate(-45)").style("text-anchor","end"),i.append("g").attr("transform",`translate(${o.left}, 0)`).call($);const S=d3.line().x(k=>d(k.date)).y(k=>m(k.value)).curve(d3.curveMonotoneX);i.append("path").datum(T).attr("fill","none").attr("stroke","blue").attr("stroke-width",2).attr("d",S),i.append("text").attr("x",900/2).attr("y",o.top/2).attr("text-anchor","middle").style("font-size","20px").style("font-weight","bold").text("Normalized Species Reported Over Time at the GSL"),i.append("text").attr("x",900/2).attr("y",500-o.bottom/2+30).attr("text-anchor","middle").style("font-size","16px").text("Time (Year-Month)"),i.append("text").attr("transform","rotate(-90)").attr("x",-500/2).attr("y",o.left/3).attr("text-anchor","middle").style("font-size","16px").text("Normalized Species Reported")}async function oi(t,e,n,r){const s=(await(await fetch(t)).json()).features||[],a=new Map;s.forEach(b=>{var L,N;const A=(L=b.properties)==null?void 0:L.observation_date,S=parseInt(((N=b.properties)==null?void 0:N.species_reported)||"0",10);if(!A||isNaN(S))return;const k=new Date(A),M=`${k.getFullYear()}-${String(k.getMonth()+1).padStart(2,"0")}`;a.has(M)||a.set(M,{totalSpecies:0,count:0});const C=a.get(M);C.totalSpecies+=S,C.count+=1});const c=Array.from(a.keys()).sort(),u=c.map(b=>{const A=a.get(b);return A.totalSpecies/A.count}),l=d3.max(u)||1,f=u.map(b=>b/l),p={};c.forEach((b,A)=>{const S=b.split("-")[0];p[S]||(p[S]=Array(12).fill(0)),p[S][parseInt(b.split("-")[1],10)-1]=f[A]});const y=n,v=r,h=d3.select(e);h.style.display="block",h.selectAll("*").remove();const _=p[y]||Array(12).fill(0),T=p[v]||Array(12).fill(0),d=Math.min(d3.min(_),d3.min(T)),m=Math.max(d3.max(_),d3.max(T)),g=d3.scaleBand().domain(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]).range([50,850]).padding(.1),x=d3.scaleLinear().domain([d,m]).range([550,50]);h.append("g").attr("transform","translate(0,550)").call(d3.axisBottom(g)),h.append("g").attr("transform","translate(50,0)").call(d3.axisLeft(x));const $=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];h.append("path").data([_]).attr("fill","none").attr("stroke","blue").attr("stroke-width",2).attr("d",d3.line().x((b,A)=>g($[A])+g.bandwidth()/2).y(b=>x(b))),h.append("path").data([T]).attr("fill","none").attr("stroke","red").attr("stroke-width",2).attr("d",d3.line().x((b,A)=>g($[A])+g.bandwidth()/2).y(b=>x(b))),h.append("text").attr("x",820).attr("y",50).attr("fill","blue").text(y),h.append("text").attr("x",820).attr("y",70).attr("fill","red").text(v),h.append("text").attr("x",450).attr("y",590).attr("text-anchor","middle").attr("font-size","14px").text("Month"),h.append("text").attr("x",-250).attr("y",15).attr("text-anchor","middle").attr("font-size","14px").attr("transform","rotate(-90)").text("Normalized Average Species Reported"),h.append("text").attr("x",450).attr("y",30).attr("text-anchor","middle").attr("font-size","20px").attr("font-weight","bold").text(`Bird Species Comparison: ${y} vs ${v}`)}async function ii(t,e,n,r){const s=(await(await fetch(t)).json()).features||[],a=new Map;s.forEach(h=>{var x,$;const _=(x=h.properties)==null?void 0:x.observation_date,T=parseInt((($=h.properties)==null?void 0:$.species_reported)||"0",10);if(!_||isNaN(T))return;const d=new Date(_),m=`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}`;a.has(m)||a.set(m,{totalSpecies:0,count:0});const g=a.get(m);g.totalSpecies+=T,g.count+=1});const c=Array.from(a.keys()).sort(),u=c.map(h=>{const _=a.get(h);return _.totalSpecies/_.count}),l=d3.max(u)||1,f=u.map(h=>h/l),p={};c.forEach((h,_)=>{const T=h.split("-")[0];p[T]||(p[T]=Array(12).fill(0)),p[T][parseInt(h.split("-")[1],10)-1]=f[_]});function y(h,_,T){const d=d3.select(T);d.style.display="block",d.selectAll("*").remove();const m=p[h]||Array(12).fill(0),g=p[_]||Array(12).fill(0),x=Math.min(d3.min(m),d3.min(g)),$=Math.max(d3.max(m),d3.max(g)),b=d3.scaleBand().domain(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]).range([50,850]).padding(.1),A=d3.scaleLinear().domain([x,$]).range([550,50]),S=d.append("g").attr("transform","translate(0,550)").call(d3.axisBottom(b)),k=d.append("g").attr("transform","translate(50,0)").call(d3.axisLeft(A));S.transition().duration(750).call(d3.axisBottom(b)),k.transition().duration(750).call(d3.axisLeft(A));const M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];d.append("path").data([m]).attr("fill","none").attr("stroke","blue").attr("stroke-width",2).attr("d",d3.line().x((N,R)=>b(M[R])+b.bandwidth()/2).y(N=>A(N))).transition().duration(750).attr("d",d3.line().x((N,R)=>b(M[R])+b.bandwidth()/2).y(N=>A(N))),d.append("path").data([g]).attr("fill","none").attr("stroke","red").attr("stroke-width",2).attr("d",d3.line().x((N,R)=>b(M[R])+b.bandwidth()/2).y(N=>A(N))).transition().duration(750).attr("d",d3.line().x((N,R)=>b(M[R])+b.bandwidth()/2).y(N=>A(N))),d.append("text").attr("x",820).attr("y",50).attr("fill","blue").text(h),d.append("text").attr("x",820).attr("y",70).attr("fill","red").text(_),d.append("text").attr("x",450).attr("y",590).attr("text-anchor","middle").attr("font-size","14px").text("Month"),d.append("text").attr("x",-250).attr("y",15).attr("text-anchor","middle").attr("font-size","14px").attr("transform","rotate(-90)").text("Normalized Average Species Reported"),d.append("text").attr("id","comparison-title").attr("class","main-title").attr("x",450).attr("y",30).attr("text-anchor","middle").attr("font-size","20px").attr("font-weight","bold").text(`Bird Species Comparison: ${h} vs ${_}`)}document.getElementById(e).addEventListener("change",function(){const h=this.value,_=document.getElementById(n).value;y(h,_,r)}),document.getElementById(n).addEventListener("change",function(){const h=document.getElementById(e).value,_=this.value;y(h,_,r)});function v(){document.getElementById(e).value=2004,document.getElementById(n).value=2023}v(),y("2004","2023",r)}function si(){mr("body").style("background-color","white");const e=document.querySelector(".opening"),n=document.querySelector(".opening_storyline"),r=document.querySelector(".vis-name");let o=0;function i(){const d=r.getBoundingClientRect().height,g=e.getBoundingClientRect().height-d;o>=50?(e.style.opacity=0,n.style.opacity=1,n.style.transform=`translateY(-${g}px)`):(e.style.opacity=1,n.style.transform="translateY(0)",n.style.opacity=0)}window.addEventListener("wheel",d=>{d.deltaY>0?o=Math.min(o+10,100):o=Math.max(o-10,0),i()});const s=document.getElementById("home-button");s.addEventListener("click",function(){window.location.reload()}),document.getElementById("about-button").addEventListener("click",function(){document.getElementById("popup").style.display="block",document.getElementById("popup-overlay").style.display="block"}),document.getElementById("close-button").addEventListener("click",function(){document.getElementById("popup").style.display="none",document.getElementById("popup-overlay").style.display="none"}),document.getElementById("grebe-button").addEventListener("click",function(){f("grebe"),s.style.display="block",s.style.opacity=1}),document.getElementById("pelican-button").addEventListener("click",function(){f("pelican"),s.style.display="block",s.style.opacity=1});const a=document.querySelector(".EG_opening"),c=document.querySelector(".grebe-content"),u=document.querySelector(".pelican-content"),l=document.querySelector(".pelican-opening");function f(d){d==="grebe"?(e.style.display="none",n.style.display="none",l.style.display="none",c.style.visibility="visible",c.style.opacity=1):d==="pelican"&&(e.style.display="none",n.style.display="none",a.style.display="none",u.style.opacity=1,u.style.visibility="visible")}const p={};for(let d=2004;d<=2023;d++)for(let m=0;m<12;m++){const g=String(m+1).padStart(2,"0"),x=`${d}-${g}`;p[x]={MX:`./amp_geojsons/monthly_MX_jsons/AMP_MX_${d}-${g}.json`,UT:`./amp_geojsons/monthly_UT_jsons/AMP_UT_${d}-${g}.json`,AZ:`./amp_geojsons/monthly_AZ_jsons/AMP_AZ_${d}-${g}.json`}}const y={};for(let d=2004;d<=2023;d++)for(let m=0;m<12;m++){const g=String(m+1).padStart(2,"0"),x=`${d}-${g}`;y[x]={MX:`./eg_geojsons/monthly_MX_jsons/EG_MX_${d}-${g}.json`,UT:`./eg_geojsons/monthly_UT_jsons/EG_UT_${d}-${g}.json`,AZ:`./eg_geojsons/monthly_AZ_jsons/EG_AZ_${d}-${g}.json`}}const v=document.getElementById("eg-map-canvas"),h=document.getElementById("pelican-map-canvas");function _(d,m){function g(){plot_map(d,m)}g(),new ResizeObserver(()=>{g()}).observe(d)}_(h,"pelican-map"),_(v,"grebe-map");function T(d,m,g,x,$,b,A,S,k,M,C,L){let N;function R(){N=plot_pixels(d,m,g,x,$,b,A,S,k,M,C,L)}return R(),new ResizeObserver(()=>{R()}).observe(d),N}document.getElementById("map_button").addEventListener("click",function(){const d=document.getElementById("pelican-slider"),m=document.getElementById("map_button"),g=document.getElementById("climate_button"),x=document.getElementById("pelican-content2");m.textContent="REPLAY ANIMATION",g.style.display="block",d.style.display="block",x.style.display="block",x.style.transition="opacity 3s ease, transform 1s ease",x.style.opacity=1;let $={animationRunning:!1,timeoutId:null};window.pelicanUpdateController=T(h,p,"pelican-map","pelican-slider","year-label","year-slider","month-label","month-slider","slider-ticks","month-ticks",$,"#info-icon-pelican")}),document.getElementById("visualize-migration").addEventListener("click",function(){const d=document.getElementById("eg-slider"),m=document.getElementById("visualize-migration"),g=document.getElementById("climate_button_eg"),x=document.getElementById("grebe-content4");m.textContent="REPLAY ANIMATION",g.style.display="block",d.style.display="block",x.style.display="block",x.style.transition="opacity 3s ease, transform 1s ease",x.style.opacity=1;let $={animationRunning:!1,timeoutId:null};window.pelicanUpdateController=T(v,y,"grebe-map","eg-slider","eg-year-label","eg-year-slider","eg-month-label","eg-month-slider","eg-slider-ticks","eg-month-ticks",$,"#info-icon-eg")}),document.getElementById("climate_button").addEventListener("click",function(){const d=document.getElementById("pelican_climate_svg"),m=document.getElementById("pelican-content3"),g=document.getElementById("pelican-content4"),x=document.getElementById("gsl_button");d.style.display="block",m.style.display="block",m.style.transition="opacity 3s ease, transform 1s ease",m.style.opacity=1,g.style.display="block",g.style.transition="opacity 3s ease, transform 1s ease",g.style.opacity=1,x.style.display="block",climate_map(d,"year-slider","month-slider")}),document.getElementById("climate_button_eg").addEventListener("click",function(){const d=document.getElementById("eg_climate_svg"),m=document.getElementById("eg-content"),g=document.getElementById("eg-content2"),x=document.getElementById("eg_gsl_button");d.style.display="block",m.style.display="block",m.style.transition="opacity 3s ease, transform 1s ease",m.style.opacity=1,g.style.display="block",g.style.transition="opacity 3s ease, transform 1s ease",g.style.opacity=1,x.style.display="block",climate_map(d,"eg-year-slider","eg-month-slider")}),document.getElementById("gsl_button").addEventListener("click",function(){const d=document.getElementById("gsl-opener");d.style.display="block",d.style.transition="opacity 3s ease, transform 1s ease",d.style.opacity=1;const m=document.getElementById("gsl_elevation_svg");m.style.display="block",plot_gsl_elevation(m,"year-slider","month-slider");const g=document.getElementById("gsl-content1");g.style.display="block",g.style.transition="opacity 3s ease, transform 1s ease",g.style.opacity=1;const x=document.getElementById("gsl_birds_plot_svg");x.style.display="block",plot_gsl_birds(x,"./amp_geojsons/filtered_AMP_UT_Year_Avgs.json");const $=document.getElementById("gsl-content2");$.style.display="block",$.style.transition="opacity 3s ease, transform 1s ease",$.style.opacity=1;const b=document.getElementById("comparison_plot_1_svg");b.style.display="block",plot_gsl_comparisons_fixed_years("./amp_geojsons/filtered_AMP_UT_Year_Avgs.json","#comparison_plot_1_svg","2009","2011");const A=document.getElementById("comparison_plot1");A.style.display="block",A.style.transition="opacity 3s ease, transform 1s ease",A.style.opacity=1;const S=document.getElementById("comparison_plot_2_svg");S.style.display="block",plot_gsl_comparisons_fixed_years("./amp_geojsons/filtered_AMP_UT_Year_Avgs.json","#comparison_plot_2_svg","2010","2011");const k=document.getElementById("comparison_plot2");k.style.display="block",k.style.transition="opacity 3s ease, transform 1s ease",k.style.opacity=1;const M=document.getElementById("comparison_plot_3_svg");M.style.display="block",plot_gsl_comparisons_fixed_years("./amp_geojsons/filtered_AMP_UT_Year_Avgs.json","#comparison_plot_3_svg","2015","2023");const C=document.getElementById("comparison_plot3");C.style.display="block",C.style.transition="opacity 3s ease, transform 1s ease",C.style.opacity=1;const L=document.getElementById("gsl_comparison_plots_svg");L.style.display="block",plot_gsl_comparisons("./amp_geojsons/filtered_AMP_UT_Year_Avgs.json","year1-dropdown","year2-dropdown","#gsl_comparison_plots_svg");const N=document.getElementById("dropdown-container");N.style.display="block";const R=document.getElementById("story_end");R.style.display="block",R.style.transition="opacity 3s ease, transform 1s ease",R.style.opacity=1;const E=document.getElementById("switch-story-button");E.style.display="block",E.style.opacity=1,E.addEventListener("click",function(){window.location.reload()})}),document.getElementById("eg_gsl_button").addEventListener("click",function(){const d=document.getElementById("eg_gsl_elevation_svg");d.style.display="block",plot_gsl_elevation(d,"eg-year-slider","eg-month-slider");const m=document.getElementById("eg-gsl-content1");m.style.display="block",m.style.transition="opacity 3s ease, transform 1s ease",m.style.opacity=1;const g=document.getElementById("eg_gsl_birds_plot_svg");g.style.display="block",plot_gsl_birds(g,"./eg_geojsons/filtered_EG_UT_Year_Avgs.json");const x=document.getElementById("eg-gsl-content2");x.style.display="block",x.style.transition="opacity 3s ease, transform 1s ease",x.style.opacity=1;const $=document.getElementById("eg_comparison_plot_1_svg");$.style.display="block",plot_gsl_comparisons_fixed_years("./eg_geojsons/filtered_EG_UT_Year_Avgs.json","#eg_comparison_plot_1_svg","2009","2011");const b=document.getElementById("eg_comparison_plot2");b.style.display="block",b.style.transition="opacity 3s ease, transform 1s ease",b.style.opacity=1;const A=document.getElementById("eg_comparison_plot_2_svg");A.style.display="block",plot_gsl_comparisons_fixed_years("./eg_geojsons/filtered_EG_UT_Year_Avgs.json","#eg_comparison_plot_2_svg","2011","2015");const S=document.getElementById("eg_comparison_plot1");S.style.display="block",S.style.transition="opacity 3s ease, transform 1s ease",S.style.opacity=1;const k=document.getElementById("eg_gsl_comparison_plots_svg");k.style.display="block",plot_gsl_comparisons("./eg_geojsons/filtered_EG_UT_Year_Avgs.json","eg-year1-dropdown","eg-year2-dropdown","#eg_gsl_comparison_plots_svg");const M=document.getElementById("eg-dropdown-container");M.style.display="block";const C=document.getElementById("eg_story_end");C.style.display="block",C.style.transition="opacity 3s ease, transform 1s ease",C.style.opacity=1;const L=document.getElementById("eg-switch-story-button");L.style.display="block",L.style.opacity=1,L.addEventListener("click",function(){window.location.reload()})})}si();
